<% content_for :meta_title, t('.title', name: @entity.name) %>
<% content_for :hide_sidebar, '1' %>

<article class="entity-page">
  <h1><%= @entity.name %></h1>
  <ul class="actions">
    <li><%= back_icon(admin_groups_path) %></li>
    <li><%= edit_icon(edit_group_path(@entity.id)) %></li>
  </ul>

  <section id="group-users">
    <h2><%= t(:user_count, count: @entity.users_count) %></h2>

    <%= paginate @collection %>
    <%= render partial: '/admin/groups/users/list', locals: { collection: @collection, group: @entity } %>
    <%= paginate @collection %>
  </section>

  <section data-filter-url="<%= users_path(format: :json) %>">
    <h2><%= t('.add_user') %></h2>

    <%= render partial: 'users/filter', locals: { filter: {} } %>

    <ul class="list-of-entities" id="found-users"></ul>
  </section>
</article>

<script>
  'use strict';

  $(function() {
      $('form.filter').on('submit', function(e) {
          e.preventDefault();

          var url = $(this).closest('section').data('filter-url');

          $.get(url, function (response) {
              if (!response.hasOwnProperty('data')) {
                  return;
              }
              console.log(response['data']);
          }).fail(handle_ajax_failure);
      })
  })
</script>